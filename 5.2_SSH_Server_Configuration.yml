# It run based on hosts
- name: 5.2 SSH Server Configuration
  hosts: Dev

  tasks:
  - name: "5.2.8 Ensure SSH root login is disabled"
    lineinfile:
      state: present
      dest: /etc/ssh/sshd_config
      regexp: ^#?PermitRootLogin
      line: PermitRootLogin no
      validate: sshd -tf %s
      notify: reload sshd
  - name: "5.2.13 Ensure SSH Idle Timeout Interval is configured - ClientAliveCountMax"
      lineinfile:
      state: present
      dest: /etc/ssh/sshd_config
      regexp: ^#?ClientAliveCountMax 900
      line: ClientAliveCountMax 
      validate: sshd -tf %s
      notify: reload sshd
  - name: "5.2.13 Ensure SSH LoginGraceTime is set to one minute or less"
      lineinfile:
      state: present
      dest: /etc/ssh/sshd_config
      regexp: ^#?LoginGraceTime
      line: LoginGraceTime 60
      validate: sshd -tf %s
      notify: reload sshd
